<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Admin Panel</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Specific Admin Styles */
        body { background: #f4f4f4; color: #333; padding: 20px; }
        .admin-container { 
            max-width: 1200px; 
            margin: 20px auto; 
            padding: 40px; 
            background: white; 
            box-shadow: 0 0 20px rgba(0,0,0,0.1); 
            border-radius: 8px;
        }
        h1, h2 { color: #04016f; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 30px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #04016f; color: white; font-family: 'Nexa', sans-serif; font-weight: 700; }
        tr:nth-child(even) { background-color: #f9f9f9; }

        .btn-download { 
            background: #ccae45; /* Gold Accent */
            color: white; 
            padding: 10px 20px; 
            text-decoration: none; 
            display: inline-block; 
            cursor: pointer; 
            border: none; 
            border-radius: 4px;
            font-weight: bold;
            margin-bottom: 10px;
            transition: 0.3s;
        }
        .btn-download:hover { background: #030145; }

        #loginOverlay { 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 999; 
        }
        .login-box {
            text-align: center;
            padding: 40px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        #adminPass { padding: 10px; width: 200px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 15px; }
        .login-box button { padding: 10px 20px; background: #04016f; color: white; border: none; cursor: pointer; border-radius: 4px; transition: 0.3s;}
        .login-box button:hover { background: #ccae45; color: #030145;}
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-box">
            <h2 style="border:none;">Admin Login</h2>
            <p>Please enter the secret password</p>
            <input type="password" id="adminPass" placeholder="Password">
            <br>
            <button onclick="checkPass()">Enter</button>
        </div>
    </div>

    <div class="admin-container">
        <h1>Wedding Guest List</h1>
        <button onclick="exportTableToExcel('guestTable', 'Wedding_Guest_List.xls')" class="btn-download">
            <i class="fas fa-file-excel"></i> Download Guest List
        </button>
        <p id="totalCount" style="font-weight: bold;">Total Guests: Loading...</p>
        
        <table id="guestTable">
            <thead>
                <tr>
                    <th>Main Contact</th>
                    <th>Email</th>
                    <th>Guest Name</th>
                    <th>Dietary</th>
                    <th>Allergies/Notes</th>
                </tr>
            </thead>
            <tbody id="guestListBody">
                </tbody>
        </table>

        <h1 style="margin-top: 60px;">Bus Reservations</h1>
        <button onclick="exportTableToExcel('busTable', 'Bus_Reservations.xls')" class="btn-download" style="background-color: #04016f;">
            <i class="fas fa-bus"></i> Download Bus List
        </button>
        
        <table id="busTable">
            <thead>
                <tr>
                    <th>Main Contact</th>
                    <th>Additional Guests</th>
                    <th>Total Seats</th>
                </tr>
            </thead>
            <tbody id="busTableBody">
                </tbody>
        </table>
    </div>

    <script type="module" src="admin.js"></script>

    <script>
        function checkPass() {
            const pass = document.getElementById('adminPass').value;
            // The secret password for your wedding
            if(pass === "19062026") { 
                document.getElementById('loginOverlay').style.display = 'none';
            } else {
                alert("Incorrect password");
            }
        }

        // Allow "Enter" key to submit password
        document.getElementById('adminPass').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                checkPass();
            }
        });
    </script>
</body>
</html>